
import { Shield, ShieldAlert, ShieldCheck, AlertTriangle } from "lucide-react";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Progress } from "@/components/ui/progress";

export function VulnerabilityOverview() {
  const vulnerabilities = {
    critical: 3,
    high: 8,
    medium: 12,
    low: 6,
    total: 29,
    fixedLastWeek: 15,
  };

  const getStatusColor = (severity: string) => {
    switch (severity) {
      case "critical":
        return "text-cyber-alert";
      case "high":
        return "text-cyber-warning";
      case "medium":
        return "text-amber-500";
      case "low":
        return "text-cyber-success";
      default:
        return "text-gray-500";
    }
  };

  const calculatePercentage = (value: number) => {
    return Math.round((value / vulnerabilities.total) * 100);
  };

  return (
    <div className="space-y-4">
      <div className="grid grid-cols-4 gap-4">
        <Card>
          <CardHeader className="pb-2">
            <CardTitle className="text-sm font-medium">Critiques</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <ShieldAlert className={`h-5 w-5 ${getStatusColor("critical")}`} />
                <span className="text-2xl font-bold">{vulnerabilities.critical}</span>
              </div>
              <span className="text-xs text-muted-foreground">
                {calculatePercentage(vulnerabilities.critical)}% du total
              </span>
            </div>
            <Progress 
              value={calculatePercentage(vulnerabilities.critical)} 
              className="h-1.5 mt-2 bg-muted [&>div]:bg-cyber-alert" 
            />
          </CardContent>
        </Card>
        
        <Card>
          <CardHeader className="pb-2">
            <CardTitle className="text-sm font-medium">Élevées</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <AlertTriangle className={`h-5 w-5 ${getStatusColor("high")}`} />
                <span className="text-2xl font-bold">{vulnerabilities.high}</span>
              </div>
              <span className="text-xs text-muted-foreground">
                {calculatePercentage(vulnerabilities.high)}% du total
              </span>
            </div>
            <Progress 
              value={calculatePercentage(vulnerabilities.high)} 
              className="h-1.5 mt-2 bg-muted [&>div]:bg-cyber-warning" 
            />
          </CardContent>
        </Card>
        
        <Card>
          <CardHeader className="pb-2">
            <CardTitle className="text-sm font-medium">Moyennes</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <Shield className={`h-5 w-5 ${getStatusColor("medium")}`} />
                <span className="text-2xl font-bold">{vulnerabilities.medium}</span>
              </div>
              <span className="text-xs text-muted-foreground">
                {calculatePercentage(vulnerabilities.medium)}% du total
              </span>
            </div>
            <Progress 
              value={calculatePercentage(vulnerabilities.medium)} 
              className="h-1.5 mt-2 bg-muted [&>div]:bg-amber-500" 
            />
          </CardContent>
        </Card>
        
        <Card>
          <CardHeader className="pb-2">
            <CardTitle className="text-sm font-medium">Faibles</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <ShieldCheck className={`h-5 w-5 ${getStatusColor("low")}`} />
                <span className="text-2xl font-bold">{vulnerabilities.low}</span>
              </div>
              <span className="text-xs text-muted-foreground">
                {calculatePercentage(vulnerabilities.low)}% du total
              </span>
            </div>
            <Progress 
              value={calculatePercentage(vulnerabilities.low)} 
              className="h-1.5 mt-2 bg-muted [&>div]:bg-cyber-success" 
            />
          </CardContent>
        </Card>
      </div>

      <Card>
        <CardHeader>
          <CardTitle>Vue d'ensemble des vulnérabilités</CardTitle>
          <CardDescription>
            {vulnerabilities.total} vulnérabilités détectées, {vulnerabilities.fixedLastWeek} corrigées cette semaine
          </CardDescription>
        </CardHeader>
        <CardContent>
          <div className="space-y-2">
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <div className="h-3 w-3 rounded-full bg-cyber-alert"></div>
                <span>Critiques</span>
              </div>
              <div className="flex items-center gap-2">
                <span>{vulnerabilities.critical}</span>
                <Progress 
                  value={calculatePercentage(vulnerabilities.critical)} 
                  className="w-32 h-2 bg-muted [&>div]:bg-cyber-alert" 
                />
              </div>
            </div>
            
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <div className="h-3 w-3 rounded-full bg-cyber-warning"></div>
                <span>Élevées</span>
              </div>
              <div className="flex items-center gap-2">
                <span>{vulnerabilities.high}</span>
                <Progress 
                  value={calculatePercentage(vulnerabilities.high)} 
                  className="w-32 h-2 bg-muted [&>div]:bg-cyber-warning" 
                />
              </div>
            </div>
            
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <div className="h-3 w-3 rounded-full bg-amber-500"></div>
                <span>Moyennes</span>
              </div>
              <div className="flex items-center gap-2">
                <span>{vulnerabilities.medium}</span>
                <Progress 
                  value={calculatePercentage(vulnerabilities.medium)} 
                  className="w-32 h-2 bg-muted [&>div]:bg-amber-500" 
                />
              </div>
            </div>
            
            <div className="flex items-center justify-between">
              <div className="flex items-center gap-2">
                <div className="h-3 w-3 rounded-full bg-cyber-success"></div>
                <span>Faibles</span>
              </div>
              <div className="flex items-center gap-2">
                <span>{vulnerabilities.low}</span>
                <Progress 
                  value={calculatePercentage(vulnerabilities.low)} 
                  className="w-32 h-2 bg-muted [&>div]:bg-cyber-success" 
                />
              </div>
            </div>
          </div>
        </CardContent>
      </Card>
    </div>
  );
}
